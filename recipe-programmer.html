<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TurboChef Recipe Programmer</title>
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --light: #f9fafb;
            --white: #ffffff;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: var(--white);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        header h1 {
            color: var(--primary);
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .panel {
            background: var(--white);
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .panel h2 {
            color: var(--dark);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
        }

        .recipe-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            color: var(--dark);
            font-weight: 600;
            margin-bottom: 5px;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--light);
            border-radius: 5px;
            font-size: 14px;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .stage-container {
            background: var(--light);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .stage-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stage-number {
            background: var(--primary);
            color: var(--white);
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .stage-controls {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--secondary);
            color: var(--white);
        }

        .btn-secondary:hover {
            background: #059669;
        }

        .btn-danger {
            background: var(--danger);
            color: var(--white);
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--white);
        }

        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--light);
        }

        .code-output {
            background: #1f2937;
            color: #10b981;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            overflow-x: auto;
            min-height: 200px;
        }

        .quick-templates {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .template-btn {
            padding: 15px 10px;
            background: linear-gradient(135deg, var(--primary), #6366f1);
            color: var(--white);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-weight: 600;
        }

        .template-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px -5px rgba(37, 99, 235, 0.3);
        }

        .power-level {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
        }

        .power-btn {
            padding: 10px;
            background: var(--light);
            border: 2px solid transparent;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .power-btn:hover {
            border-color: var(--primary);
        }

        .power-btn.active {
            background: var(--primary);
            color: var(--white);
        }

        .preview-section {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .preview-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .preview-label {
            font-weight: 600;
            color: var(--dark);
        }

        .preview-value {
            color: #6b7280;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            .recipe-info {
                grid-template-columns: 1fr;
            }

            .stage-controls {
                grid-template-columns: 1fr;
            }

            .quick-templates {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: var(--white);
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--secondary);
            color: var(--white);
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .copy-btn:hover {
            background: #059669;
        }

        #savedRecipes {
            max-height: 300px;
            overflow-y: auto;
        }

        .saved-recipe-item {
            background: var(--light);
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .saved-recipe-item:hover {
            background: #e5e7eb;
            transform: translateX(5px);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üç≥ TurboChef Recipe Programmer</h1>
            <p>Create and customize cooking programs for your TurboChef High H Batch 2 oven</p>
        </header>

        <!-- Detailed Programming Instructions -->
        <div class="panel" style="background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%); margin-bottom: 20px;">
            <h2 style="color: #92400e;">üìö COMPLETE PROGRAMMING GUIDE - READ THIS FIRST!</h2>
            
            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 5px solid #ef4444;">
                <h3 style="color: #ef4444;">‚ö†Ô∏è CRITICAL: Before You Start</h3>
                <ul style="margin: 10px 0;">
                    <li><strong>OVEN MUST BE OFF OR COOLING</strong> - Cannot program while cooking!</li>
                    <li><strong>ENABLE EDIT MODE FIRST</strong> - This is required!</li>
                    <li><strong>HAVE YOUR RECIPE READY</strong> - Write down temp, time, settings first</li>
                </ul>
            </div>

            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <h3 style="color: #2563eb;">üîì Step 1: Enable Edit Mode (MUST DO FIRST!)</h3>
                <ol style="line-height: 1.8;">
                    <li><strong>HOLD</strong> the top-left OR top-right soft key (small button under screen) for <strong>5 SECONDS</strong></li>
                    <li>Screen will show options menu</li>
                    <li><strong>PRESS</strong> the soft key under "Edit Menu"</li>
                    <li><strong>TURN ON</strong> by pressing the soft key again</li>
                    <li><strong>PRESS BACK/STOP</strong> button to exit the options menu</li>
                    <li>You're now in Edit Mode! (If you skip this, programming won't work)</li>
                </ol>
            </div>

            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <h3 style="color: #2563eb;">üìù Step 2: Enter Programming Mode</h3>
                <ol style="line-height: 1.8;">
                    <li><strong>HOLD the UP ARROW</strong> button for <strong>1 SECOND</strong></li>
                    <li>Screen will change to programming mode</li>
                    <li>You'll see temperature setting first (like "350¬∞F")</li>
                </ol>
            </div>

            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <h3 style="color: #2563eb;">üå°Ô∏è Step 3: Set Temperature</h3>
                <ol style="line-height: 1.8;">
                    <li><strong>PRESS UP ARROW</strong> to increase temperature (goes up by 25¬∞F each press)</li>
                    <li><strong>PRESS DOWN ARROW</strong> to decrease temperature</li>
                    <li>Keep pressing until you reach desired temp (e.g., 475¬∞F)</li>
                    <li><strong>PRESS ENTER</strong> when temperature is correct</li>
                </ol>
            </div>

            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <h3 style="color: #2563eb;">üìÇ Step 4: Select Recipe Location</h3>
                <ol style="line-height: 1.8;">
                    <li>Screen shows groups: "1ST GROUP", "2ND GROUP", etc.</li>
                    <li><strong>PRESS</strong> the soft key under your chosen group (usually "1ST GROUP")</li>
                    <li>Screen shows items: "1ST ITEM", "2ND ITEM", etc.</li>
                    <li><strong>PRESS</strong> the soft key under your chosen slot (like "1ST ITEM" for first recipe)</li>
                </ol>
            </div>

            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <h3 style="color: #2563eb;">‚úèÔ∏è Step 5: Name Your Recipe</h3>
                <p style="margin-bottom: 10px;"><strong>Use number keys like an old phone:</strong></p>
                <div style="background: #f3f4f6; padding: 10px; border-radius: 5px; font-family: monospace; margin-bottom: 10px;">
                    Key 2 = ABC    Key 5 = JKL    Key 8 = TUV<br>
                    Key 3 = DEF    Key 6 = MNO    Key 9 = WXYZ<br>
                    Key 4 = GHI    Key 7 = PQRS   Key 0 = 0<br>
                    Key 1 = SPACE (press once for space between words)
                </div>
                <p><strong>Example - To type "PIZZA":</strong></p>
                <ul>
                    <li>Press 7 once = P</li>
                    <li>Press 4 three times = I</li>
                    <li>Press 9 four times = Z</li>
                    <li>Press 9 four times = Z</li>
                    <li>Press 2 once = A</li>
                </ul>
                <p><strong>Press RIGHT ARROW</strong> when done naming to move to time setting</p>
            </div>

            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <h3 style="color: #2563eb;">‚è±Ô∏è Step 6: Set Cook Time</h3>
                <ol style="line-height: 1.8;">
                    <li><strong>PRESS UP ARROW</strong> to increase time (adds 5 seconds each press)</li>
                    <li><strong>PRESS DOWN ARROW</strong> to decrease time</li>
                    <li>For 3:00 (3 minutes), press UP arrow 36 times (36 √ó 5 sec = 180 sec = 3 min)</li>
                    <li>For 10:00, press UP arrow 120 times</li>
                    <li><strong>TIP:</strong> Hold arrow down for faster scrolling!</li>
                    <li><strong>Press RIGHT ARROW</strong> when time is set</li>
                </ol>
            </div>

            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <h3 style="color: #2563eb;">üîß Step 7: Set Rack & Air Settings</h3>
                <ol style="line-height: 1.8;">
                    <li><strong>Rack Setting:</strong> Press UP for ON, DOWN for OFF (usually ON)</li>
                    <li><strong>Press RIGHT ARROW</strong> to move to Events</li>
                    <li><strong>Event 1 - Time %:</strong> Use arrows to set (e.g., 70 = first 70% of cook time)</li>
                    <li><strong>Event 1 - Air %:</strong> Use arrows to set fan speed (e.g., 90 = 90% fan)</li>
                    <li><strong>Event 2:</strong> Automatically uses remaining time (e.g., 30% if Event 1 was 70%)</li>
                    <li><strong>Event 2 - Air %:</strong> Set fan for final portion (often 100%)</li>
                </ol>
            </div>

            <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                <h3 style="color: #10b981;">‚úÖ Step 8: Save Your Recipe</h3>
                <ol style="line-height: 1.8;">
                    <li><strong>PRESS ENTER</strong> to save the recipe</li>
                    <li>Oven will beep or show confirmation</li>
                    <li><strong>PRESS BACK/STOP</strong> to exit programming mode</li>
                    <li>Your recipe is now saved!</li>
                </ol>
            </div>

            <div style="background: #fef3c7; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 2px solid #f59e0b;">
                <h3 style="color: #92400e;">üöÄ THE LAZY METHOD - 3 Universal Settings!</h3>
                <p style="margin-bottom: 10px;"><strong>Don't want to program complex recipes? Use these 3 settings for EVERYTHING:</strong></p>
                
                <div style="background: white; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                    <h4 style="color: #2563eb;">Setting 1: FROZEN FOODS</h4>
                    <ul>
                        <li><strong>Temperature:</strong> 500¬∞F</li>
                        <li><strong>Air:</strong> 100%</li>
                        <li><strong>Rack:</strong> ON</li>
                        <li><strong>Time:</strong> Adjust based on item (3-10 minutes usually)</li>
                        <li><strong>Use for:</strong> Frozen fries, nuggets, pizza, egg rolls, anything frozen</li>
                    </ul>
                </div>

                <div style="background: white; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                    <h4 style="color: #10b981;">Setting 2: FRESH FOODS</h4>
                    <ul>
                        <li><strong>Temperature:</strong> 475¬∞F</li>
                        <li><strong>Air:</strong> 80%</li>
                        <li><strong>Rack:</strong> ON</li>
                        <li><strong>Time:</strong> Adjust based on item (2-8 minutes usually)</li>
                        <li><strong>Use for:</strong> Fresh meats, sandwiches, vegetables, anything not frozen</li>
                    </ul>
                </div>

                <div style="background: white; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
                    <h4 style="color: #f59e0b;">Setting 3: REHEAT</h4>
                    <ul>
                        <li><strong>Temperature:</strong> 425¬∞F</li>
                        <li><strong>Air:</strong> 60%</li>
                        <li><strong>Rack:</strong> ON</li>
                        <li><strong>Time:</strong> 2:00 (2 minutes) for most items</li>
                        <li><strong>Use for:</strong> Leftover pizza, old fries, yesterday's sandwich</li>
                    </ul>
                </div>

                <p style="margin-top: 10px;"><strong>üí° PRO TIP:</strong> Start with these settings, then just adjust the TIME up or down until food looks good!</p>
            </div>

            <div style="background: white; padding: 15px; border-radius: 8px;">
                <h3 style="color: #ef4444;">üõë Common Mistakes to Avoid</h3>
                <ul style="line-height: 1.8;">
                    <li>‚ùå <strong>Forgetting to enable Edit Mode first</strong> - Nothing will save!</li>
                    <li>‚ùå <strong>Programming while oven is hot</strong> - Must be OFF or cooling</li>
                    <li>‚ùå <strong>Not pressing ENTER to save</strong> - Recipe won't be stored</li>
                    <li>‚ùå <strong>Wrong number key presses</strong> - Count carefully for letters</li>
                    <li>‚ùå <strong>Forgetting rack setting</strong> - Usually should be ON</li>
                </ul>
            </div>
        </div>

        <div class="main-grid">
            <!-- Left Panel - Recipe Builder -->
            <div class="panel">
                <h2>Recipe Builder</h2>

                <!-- Quick Templates -->
                <div class="quick-templates">
                    <button class="template-btn" onclick="loadTemplate('pizza')">üçï Pizza</button>
                    <button class="template-btn" onclick="loadTemplate('chicken')">üçó Chicken</button>
                    <button class="template-btn" onclick="loadTemplate('burger')">üçî Burger</button>
                    <button class="template-btn" onclick="loadTemplate('fish')">üêü Fish</button>
                    <button class="template-btn" onclick="loadTemplate('vegetable')">ü•¶ Vegetables</button>
                    <button class="template-btn" onclick="loadTemplate('dessert')">üç∞ Dessert</button>
                    <button class="template-btn" onclick="loadTemplate('bread')">üçû Bread</button>
                    <button class="template-btn" onclick="loadTemplate('pasta')">üçù Pasta</button>
                </div>

                <!-- Recipe Information -->
                <div class="recipe-info">
                    <div class="form-group">
                        <label>Recipe Name</label>
                        <input type="text" id="recipeName" placeholder="Enter recipe name">
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="category">
                            <option value="">Select Category</option>
                            <option value="appetizer">Appetizer</option>
                            <option value="entree">Entr√©e</option>
                            <option value="side">Side Dish</option>
                            <option value="dessert">Dessert</option>
                            <option value="breakfast">Breakfast</option>
                            <option value="snack">Snack</option>
                        </select>
                    </div>
                </div>

                <!-- Cooking Stages -->
                <div id="cookingStages">
                    <div class="stage-container" data-stage="1">
                        <div class="stage-header">
                            <span class="stage-number">Stage 1</span>
                            <button class="btn btn-danger btn-icon" onclick="removeStage(1)" style="display:none;">‚úï</button>
                        </div>
                        <div class="stage-controls">
                            <div class="form-group">
                                <label>Temperature (¬∞F)</label>
                                <input type="number" id="temp1" min="100" max="500" value="350">
                            </div>
                            <div class="form-group">
                                <label>Time (seconds)</label>
                                <input type="number" id="time1" min="1" max="600" value="60">
                            </div>
                            <div class="form-group">
                                <label>Fan Speed (%)</label>
                                <input type="number" id="fan1" min="0" max="100" value="80">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Microwave Power</label>
                            <div class="power-level">
                                <button class="power-btn" onclick="setPower(1, 0)">Off</button>
                                <button class="power-btn" onclick="setPower(1, 25)">25%</button>
                                <button class="power-btn active" onclick="setPower(1, 50)">50%</button>
                                <button class="power-btn" onclick="setPower(1, 75)">75%</button>
                                <button class="power-btn" onclick="setPower(1, 100)">100%</button>
                            </div>
                            <input type="hidden" id="power1" value="50">
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="addStage()">+ Add Stage</button>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="generateCode()">Generate Code</button>
                    <button class="btn btn-primary" onclick="saveRecipe()">Save Recipe</button>
                    <button class="btn btn-warning" onclick="resetForm()">Reset</button>
                </div>
            </div>

            <!-- Right Panel - Output & Preview -->
            <div class="panel">
                <h2>Program Output</h2>

                <!-- Code Output -->
                <div style="position: relative;">
                    <button class="copy-btn" onclick="copyCode()">Copy Code</button>
                    <div class="code-output" id="codeOutput">
// Recipe code will appear here
// Click "Generate Code" to create your program
                    </div>
                </div>

                <!-- Preview Section -->
                <div class="preview-section">
                    <h3 style="margin-bottom: 15px;">Recipe Preview</h3>
                    <div id="recipePreview">
                        <div class="preview-item">
                            <span class="preview-label">Total Cook Time:</span>
                            <span class="preview-value" id="totalTime">0 seconds</span>
                        </div>
                        <div class="preview-item">
                            <span class="preview-label">Max Temperature:</span>
                            <span class="preview-value" id="maxTemp">0¬∞F</span>
                        </div>
                        <div class="preview-item">
                            <span class="preview-label">Number of Stages:</span>
                            <span class="preview-value" id="stageCount">1</span>
                        </div>
                        <div class="preview-item">
                            <span class="preview-label">Energy Efficiency:</span>
                            <span class="preview-value" id="efficiency">Standard</span>
                        </div>
                    </div>
                </div>

                <!-- Saved Recipes -->
                <div class="panel" style="margin-top: 20px;">
                    <h3>Saved Recipes</h3>
                    <div id="savedRecipes">
                        <!-- Saved recipes will appear here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let stageCount = 1;
        let savedRecipes = JSON.parse(localStorage.getItem('turboChefRecipes') || '[]');

        // Template recipes
        const templates = {
            pizza: {
                name: 'Classic Pizza',
                stages: [
                    { temp: 450, time: 180, fan: 100, power: 75 }
                ]
            },
            chicken: {
                name: 'Crispy Chicken',
                stages: [
                    { temp: 375, time: 120, fan: 80, power: 50 },
                    { temp: 400, time: 60, fan: 100, power: 25 }
                ]
            },
            burger: {
                name: 'Perfect Burger',
                stages: [
                    { temp: 425, time: 90, fan: 90, power: 60 }
                ]
            },
            fish: {
                name: 'Grilled Fish',
                stages: [
                    { temp: 350, time: 120, fan: 70, power: 40 }
                ]
            },
            vegetable: {
                name: 'Roasted Vegetables',
                stages: [
                    { temp: 375, time: 90, fan: 85, power: 30 }
                ]
            },
            dessert: {
                name: 'Chocolate Cake',
                stages: [
                    { temp: 325, time: 180, fan: 60, power: 20 },
                    { temp: 350, time: 60, fan: 70, power: 0 }
                ]
            },
            bread: {
                name: 'Artisan Bread',
                stages: [
                    { temp: 400, time: 240, fan: 50, power: 25 },
                    { temp: 425, time: 120, fan: 70, power: 0 }
                ]
            },
            pasta: {
                name: 'Baked Pasta',
                stages: [
                    { temp: 350, time: 150, fan: 75, power: 45 },
                    { temp: 400, time: 60, fan: 90, power: 0 }
                ]
            }
        };

        function loadTemplate(type) {
            const template = templates[type];
            if (!template) return;

            document.getElementById('recipeName').value = template.name;
            
            // Clear existing stages
            document.getElementById('cookingStages').innerHTML = '';
            stageCount = 0;

            // Add template stages
            template.stages.forEach((stage, index) => {
                addStage();
                document.getElementById(`temp${index + 1}`).value = stage.temp;
                document.getElementById(`time${index + 1}`).value = stage.time;
                document.getElementById(`fan${index + 1}`).value = stage.fan;
                document.getElementById(`power${index + 1}`).value = stage.power;
                setPower(index + 1, stage.power);
            });

            updatePreview();
            generateCode();
        }

        function addStage() {
            stageCount++;
            const stagesDiv = document.getElementById('cookingStages');
            
            const stageHTML = `
                <div class="stage-container" data-stage="${stageCount}">
                    <div class="stage-header">
                        <span class="stage-number">Stage ${stageCount}</span>
                        <button class="btn btn-danger btn-icon" onclick="removeStage(${stageCount})">‚úï</button>
                    </div>
                    <div class="stage-controls">
                        <div class="form-group">
                            <label>Temperature (¬∞F)</label>
                            <input type="number" id="temp${stageCount}" min="100" max="500" value="350" onchange="updatePreview()">
                        </div>
                        <div class="form-group">
                            <label>Time (seconds)</label>
                            <input type="number" id="time${stageCount}" min="1" max="600" value="60" onchange="updatePreview()">
                        </div>
                        <div class="form-group">
                            <label>Fan Speed (%)</label>
                            <input type="number" id="fan${stageCount}" min="0" max="100" value="80" onchange="updatePreview()">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Microwave Power</label>
                        <div class="power-level">
                            <button class="power-btn" onclick="setPower(${stageCount}, 0)">Off</button>
                            <button class="power-btn" onclick="setPower(${stageCount}, 25)">25%</button>
                            <button class="power-btn active" onclick="setPower(${stageCount}, 50)">50%</button>
                            <button class="power-btn" onclick="setPower(${stageCount}, 75)">75%</button>
                            <button class="power-btn" onclick="setPower(${stageCount}, 100)">100%</button>
                        </div>
                        <input type="hidden" id="power${stageCount}" value="50">
                    </div>
                </div>
            `;
            
            stagesDiv.insertAdjacentHTML('beforeend', stageHTML);
            
            // Show remove button on first stage if there are multiple stages
            if (stageCount > 1) {
                document.querySelector('.stage-container[data-stage="1"] .btn-danger').style.display = 'block';
            }
            
            updatePreview();
        }

        function removeStage(stageNum) {
            const stage = document.querySelector(`.stage-container[data-stage="${stageNum}"]`);
            if (stage && stageCount > 1) {
                stage.remove();
                stageCount--;
                renumberStages();
                updatePreview();
            }
        }

        function renumberStages() {
            const stages = document.querySelectorAll('.stage-container');
            stages.forEach((stage, index) => {
                const newNum = index + 1;
                stage.dataset.stage = newNum;
                stage.querySelector('.stage-number').textContent = `Stage ${newNum}`;
                
                // Update IDs
                const oldNum = parseInt(stage.querySelector('[id^="temp"]').id.replace('temp', ''));
                stage.querySelector(`#temp${oldNum}`).id = `temp${newNum}`;
                stage.querySelector(`#time${oldNum}`).id = `time${newNum}`;
                stage.querySelector(`#fan${oldNum}`).id = `fan${newNum}`;
                stage.querySelector(`#power${oldNum}`).id = `power${newNum}`;
            });
            
            // Hide remove button if only one stage
            if (stages.length === 1) {
                stages[0].querySelector('.btn-danger').style.display = 'none';
            }
        }

        function setPower(stage, value) {
            document.getElementById(`power${stage}`).value = value;
            
            // Update button states
            const buttons = document.querySelectorAll(`.stage-container[data-stage="${stage}"] .power-btn`);
            buttons.forEach(btn => btn.classList.remove('active'));
            
            const powerMap = { 0: 0, 25: 1, 50: 2, 75: 3, 100: 4 };
            if (buttons[powerMap[value]]) {
                buttons[powerMap[value]].classList.add('active');
            }
            
            updatePreview();
        }

        function generateCode() {
            const recipeName = document.getElementById('recipeName').value || 'Custom Recipe';
            const category = document.getElementById('category').value || 'general';
            
            let code = `// TurboChef High H Batch 2 Recipe Program\n`;
            code += `// Recipe: ${recipeName}\n`;
            code += `// Category: ${category}\n`;
            code += `// Generated: ${new Date().toLocaleString()}\n\n`;
            
            code += `RECIPE_START "${recipeName}"\n`;
            code += `CATEGORY "${category}"\n\n`;
            
            for (let i = 1; i <= stageCount; i++) {
                const temp = document.getElementById(`temp${i}`)?.value || 350;
                const time = document.getElementById(`time${i}`)?.value || 60;
                const fan = document.getElementById(`fan${i}`)?.value || 80;
                const power = document.getElementById(`power${i}`)?.value || 50;
                
                code += `// Stage ${i}\n`;
                code += `STAGE ${i} {\n`;
                code += `  TEMP: ${temp}¬∞F\n`;
                code += `  TIME: ${time} seconds\n`;
                code += `  FAN_SPEED: ${fan}%\n`;
                code += `  MICROWAVE: ${power}%\n`;
                code += `}\n\n`;
            }
            
            code += `RECIPE_END\n\n`;
            code += `// Instructions:\n`;
            code += `// 1. Enter this program into your TurboChef oven\n`;
            code += `// 2. Save with recipe number\n`;
            code += `// 3. Test with sample product\n`;
            code += `// 4. Adjust parameters as needed`;
            
            document.getElementById('codeOutput').textContent = code;
            updatePreview();
        }

        function updatePreview() {
            let totalTime = 0;
            let maxTemp = 0;
            let totalPower = 0;
            
            for (let i = 1; i <= stageCount; i++) {
                const time = parseInt(document.getElementById(`time${i}`)?.value || 0);
                const temp = parseInt(document.getElementById(`temp${i}`)?.value || 0);
                const power = parseInt(document.getElementById(`power${i}`)?.value || 0);
                
                totalTime += time;
                maxTemp = Math.max(maxTemp, temp);
                totalPower += power;
            }
            
            document.getElementById('totalTime').textContent = `${totalTime} seconds (${Math.floor(totalTime/60)}:${(totalTime%60).toString().padStart(2,'0')})`;
            document.getElementById('maxTemp').textContent = `${maxTemp}¬∞F`;
            document.getElementById('stageCount').textContent = stageCount;
            
            // Calculate efficiency
            const avgPower = totalPower / stageCount;
            let efficiency = 'Standard';
            if (avgPower < 30) efficiency = 'High Efficiency';
            else if (avgPower > 70) efficiency = 'High Power';
            
            document.getElementById('efficiency').textContent = efficiency;
        }

        function saveRecipe() {
            const recipeName = document.getElementById('recipeName').value || 'Unnamed Recipe';
            
            const recipe = {
                name: recipeName,
                category: document.getElementById('category').value,
                stages: [],
                timestamp: new Date().toISOString()
            };
            
            for (let i = 1; i <= stageCount; i++) {
                recipe.stages.push({
                    temp: document.getElementById(`temp${i}`).value,
                    time: document.getElementById(`time${i}`).value,
                    fan: document.getElementById(`fan${i}`).value,
                    power: document.getElementById(`power${i}`).value
                });
            }
            
            savedRecipes.unshift(recipe);
            if (savedRecipes.length > 10) savedRecipes = savedRecipes.slice(0, 10);
            
            localStorage.setItem('turboChefRecipes', JSON.stringify(savedRecipes));
            displaySavedRecipes();
            
            alert(`Recipe "${recipeName}" saved successfully!`);
        }

        function displaySavedRecipes() {
            const container = document.getElementById('savedRecipes');
            
            if (savedRecipes.length === 0) {
                container.innerHTML = '<p style="color: #999;">No saved recipes yet</p>';
                return;
            }
            
            container.innerHTML = savedRecipes.map(recipe => `
                <div class="saved-recipe-item" onclick='loadSavedRecipe(${JSON.stringify(recipe)})'>
                    <strong>${recipe.name}</strong><br>
                    <small>${recipe.stages.length} stages | ${new Date(recipe.timestamp).toLocaleDateString()}</small>
                </div>
            `).join('');
        }

        function loadSavedRecipe(recipe) {
            document.getElementById('recipeName').value = recipe.name;
            document.getElementById('category').value = recipe.category || '';
            
            // Clear and rebuild stages
            document.getElementById('cookingStages').innerHTML = '';
            stageCount = 0;
            
            recipe.stages.forEach((stage, index) => {
                addStage();
                document.getElementById(`temp${index + 1}`).value = stage.temp;
                document.getElementById(`time${index + 1}`).value = stage.time;
                document.getElementById(`fan${index + 1}`).value = stage.fan;
                document.getElementById(`power${index + 1}`).value = stage.power;
                setPower(index + 1, stage.power);
            });
            
            generateCode();
        }

        function copyCode() {
            const code = document.getElementById('codeOutput').textContent;
            navigator.clipboard.writeText(code).then(() => {
                const btn = document.querySelector('.copy-btn');
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                btn.style.background = '#10b981';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 2000);
            });
        }

        function resetForm() {
            if (confirm('Are you sure you want to reset the form?')) {
                document.getElementById('recipeName').value = '';
                document.getElementById('category').value = '';
                document.getElementById('cookingStages').innerHTML = '';
                stageCount = 0;
                addStage();
                document.getElementById('codeOutput').textContent = '// Recipe code will appear here\n// Click "Generate Code" to create your program';
                updatePreview();
            }
        }

        // Existing TurboChef recipes database
        const existingRecipes = [
            { name: 'üçó Chicken Wings (frozen)', temp: 450, time: 840, category: 'Poultry' },
            { name: 'üçï Pizza 16" Fresh', temp: 500, time: 180, category: 'Pizza' },
            { name: 'üßÄ Mozzarella Sticks', temp: 500, time: 190, category: 'Appetizer' },
            { name: 'üçó Chicken Tenders', temp: 500, time: 135, category: 'Poultry' },
            { name: 'üçü French Fries', temp: 500, time: 240, category: 'Sides' },
            { name: 'ü•™ Grilled Cheese', temp: 475, time: 90, category: 'Sandwich' },
            { name: 'üßÄ Mac & Cheese Bites', temp: 475, time: 105, category: 'Appetizer' },
            { name: 'üç≥ Breakfast Sandwich', temp: 500, time: 105, category: 'Breakfast' },
            { name: 'üçó Chicken Breast (raw)', temp: 500, time: 350, category: 'Poultry' },
            { name: 'üçï Pizza 14" Frozen', temp: 500, time: 390, category: 'Pizza' },
            { name: 'üåÆ Quesadilla', temp: 500, time: 60, category: 'Mexican' },
            { name: 'üç™ Chocolate Chip Cookies', temp: 350, time: 420, category: 'Dessert' },
            { name: 'ü•î Tater Tots', temp: 500, time: 165, category: 'Sides' },
            { name: 'üçî Hamburger (precooked)', temp: 500, time: 120, category: 'Sandwich' },
            { name: 'üåÆ Nachos', temp: 500, time: 90, category: 'Mexican' },
            { name: 'ü•Ø Bagel, Toasted', temp: 500, time: 35, category: 'Breakfast' },
            { name: 'üå≠ Corn Dogs', temp: 500, time: 60, category: 'Sandwich' },
            { name: 'ü•ü Egg Rolls', temp: 500, time: 120, category: 'Appetizer' },
            { name: 'ü•î Hash Browns', temp: 500, time: 180, category: 'Breakfast' },
            { name: 'üç∞ Lava Cake', temp: 500, time: 75, category: 'Dessert' },
            { name: 'ü•ñ Sub Sandwich 6"', temp: 500, time: 25, category: 'Sandwich' },
            { name: 'ü•î Baked Potato', temp: 450, time: 360, category: 'Sides' },
            { name: 'üçó Chicken Nuggets', temp: 500, time: 90, category: 'Poultry' },
            { name: 'üêü Fish Filet (breaded)', temp: 500, time: 120, category: 'Seafood' },
            { name: 'üßÖ Onion Rings', temp: 475, time: 150, category: 'Appetizer' },
            { name: 'üåØ Burrito', temp: 500, time: 75, category: 'Mexican' },
            { name: 'üçï Pizza Personal 8"', temp: 500, time: 70, category: 'Pizza' },
            { name: 'üçó Popcorn Chicken', temp: 500, time: 120, category: 'Poultry' },
            { name: 'üêü Salmon (fresh)', temp: 450, time: 120, category: 'Seafood' },
            { name: 'üå∂Ô∏è Jalapeno Poppers', temp: 450, time: 240, category: 'Appetizer' }
        ];

        function displayExistingRecipes() {
            const container = document.getElementById('existingRecipesList');
            const html = existingRecipes.map(recipe => `
                <div class="existing-recipe-item" onclick="loadExistingRecipe('${recipe.name}', ${recipe.temp}, ${recipe.time})">
                    <div style="font-weight: bold;">${recipe.name}</div>
                    <div style="font-size: 0.9rem; color: #6b7280;">
                        ${recipe.temp}¬∞F | ${Math.floor(recipe.time/60)}:${(recipe.time%60).toString().padStart(2,'0')} | ${recipe.category}
                    </div>
                </div>
            `).join('');
            container.innerHTML = html;
        }

        function loadExistingRecipe(name, temp, time) {
            document.getElementById('recipeName').value = name.replace(/[üçóüçïüßÄüçüü•™üßÄüç≥üåÆüç™ü•îüçîü•Øüå≠ü•üüç∞ü•ñüêüüßÖüåØüå∂Ô∏è]/g, '').trim();
            
            // Clear stages and add one with the recipe settings
            document.getElementById('cookingStages').innerHTML = '';
            stageCount = 0;
            addStage();
            
            document.getElementById('temp1').value = temp;
            document.getElementById('time1').value = time;
            document.getElementById('fan1').value = 85;
            setPower(1, 50);
            
            generateCode();
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Initialize
        displaySavedRecipes();
        updatePreview();

        // Add event listeners for real-time preview updates
        document.addEventListener('input', function(e) {
            if (e.target.type === 'number' || e.target.type === 'text') {
                updatePreview();
            }
        });
    </script>

    <!-- Existing Recipes Section at Bottom -->
    <div style="max-width: 1400px; margin: 40px auto 20px; padding: 0 20px;">
        <div class="panel">
            <h2>üìñ Existing TurboChef Recipe Library</h2>
            <p style="color: #6b7280; margin-bottom: 20px;">Click any recipe below to load it into the programmer above</p>
            
            <div id="existingRecipesList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px;">
                <!-- Recipes will be populated here -->
            </div>
        </div>
    </div>

    <style>
        .existing-recipe-item {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .existing-recipe-item:hover {
            background: linear-gradient(135deg, #ddd6fe 0%, #c7d2fe 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }
    </style>

    <script>
        // Call this function on page load
        displayExistingRecipes();
    </script>
</body>
</html>